<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Date #3 Protocol</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Press+Start+2P&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --bg-color: #f0f0f0;
            --primary: #FF90E8; /* Y2K Pink */
            --secondary: #23A6D5; /* Cyan */
            --accent: #FFC900; /* Yellow */
            --dark: #000000;
            --light: #ffffff;
            --border-thick: 3px solid var(--dark);
            --shadow-hard: 5px 5px 0px var(--dark);
            --shadow-hover: 2px 2px 0px var(--dark);
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            cursor: crosshair;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            background-color: #E0E7FF;
            background-image: 
                radial-gradient(#FF90E8 1px, transparent 1px), 
                radial-gradient(#23A6D5 1px, transparent 1px);
            background-position: 0 0, 25px 25px;
            background-size: 50px 50px;
            color: var(--dark);
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(
                to bottom,
                rgba(255,255,255,0),
                rgba(255,255,255,0) 50%,
                rgba(0,0,0,0.05) 50%,
                rgba(0,0,0,0.05)
            );
            background-size: 100% 4px;
            pointer-events: none;
            z-index: 999;
        }

        .main-container {
            width: 90%;
            max-width: 450px;
            background: rgba(255, 255, 255, 0.95);
            border: var(--border-thick);
            box-shadow: var(--shadow-hard);
            padding: 2rem;
            position: relative;
            border-radius: 10px;
            backdrop-filter: blur(5px);
            animation: float 6s ease-in-out infinite;
            z-index: 10;
            margin-bottom: 40px;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        h1, h2, h3 {
            font-family: 'Press Start 2P', cursive;
            line-height: 1.4;
            text-transform: uppercase;
        }

        h1 {
            font-size: 1.1rem;
            text-align: center;
            color: var(--dark);
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 0px var(--primary);
        }

        .subtitle {
            text-align: center;
            font-size: 0.8rem;
            margin-bottom: 2rem;
            font-weight: 700;
            color: #555;
            background: var(--accent);
            display: inline-block;
            padding: 5px;
            border: 2px solid var(--dark);
            transform: rotate(-2deg);
        }

        .center-wrapper {
            display: flex;
            justify-content: center;
            width: 100%;
        }

        .screen {
            display: none;
            flex-direction: column;
            align-items: center;
        }

        .screen.active {
            display: flex;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-retro {
            background: var(--primary);
            color: white;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.9rem;
            padding: 15px 30px;
            border: var(--border-thick);
            box-shadow: var(--shadow-hard);
            cursor: crosshair;
            transition: all 0.2s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            margin-top: 20px;
            text-transform: uppercase;
            width: 100%;
            text-align: center;
        }

        .btn-retro:hover {
            transform: translate(-2px, -2px);
            box-shadow: 7px 7px 0px var(--dark);
            background: #ff5ec4;
        }

        .btn-retro:active {
            transform: translate(2px, 2px);
            box-shadow: 0px 0px 0px var(--dark);
        }

        .card-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            width: 100%;
        }

        .option-card {
            background: white;
            border: var(--border-thick);
            padding: 15px;
            border-radius: 8px;
            cursor: crosshair;
            transition: transform 0.3s cubic-bezier(0.18, 0.89, 0.32, 1.28), background 0.2s;
            position: relative;
            overflow: hidden;
        }

        .option-card:hover {
            transform: scale(1.05) rotate(-1deg);
            z-index: 10;
            box-shadow: var(--shadow-hard);
        }

        .option-card.selected {
            background: #fff9e6;
            border-color: var(--secondary);
            box-shadow: 5px 5px 0px var(--secondary);
            transform: scale(1.02);
        }

        .option-card.selected::before {
            content: '‚úÖ';
            position: absolute;
            right: 10px;
            top: 10px;
            font-size: 1.5rem;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .card-emoji {
            font-size: 2rem;
            margin-right: 10px;
        }

        .card-badge {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.5rem;
            background: var(--dark);
            color: var(--accent);
            padding: 4px 8px;
            border-radius: 4px;
        }

        .card-title {
            font-weight: 900;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }

        .card-desc {
            font-size: 0.85rem;
            color: #666;
            line-height: 1.3;
            font-weight: 600;
        }

        .disclaimer {
            font-size: 0.6rem;
            margin-top: 20px;
            color: #888;
            text-align: center;
            font-family: monospace;
        }

        .error-msg { 
            margin-top: 15px;
            min-height: 20px;
            color: #ff0055; 
            font-family: 'Press Start 2P', cursive; 
            font-size: 0.7rem; 
            text-align: center;
            display: none;
            line-height: 1.5;
        }

        /* --- DATA PICKER STYLES --- */
        .date-wrapper {
            margin-top: 25px;
            width: 100%;
        }
        
        .date-label {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            margin-bottom: 10px;
            display: block;
            color: var(--dark);
        }

        .retro-input {
            width: 100%;
            padding: 15px;
            font-family: 'Inter', sans-serif; /* Mai lizibil pt date */
            font-weight: bold;
            font-size: 1rem;
            border: var(--border-thick);
            background: #fff;
            box-shadow: var(--shadow-hover);
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            border-radius: 5px;
        }

        .retro-input:focus {
            background-color: #fcfce8;
            box-shadow: var(--shadow-hard);
        }

        footer {
            margin-top: 30px;
            text-align: center;
            font-size: 0.7rem;
            opacity: 0.5;
            cursor: help;
            padding: 10px;
            user-select: none;
            transition: opacity 0.3s;
        }

        footer:hover {
            opacity: 1;
        }

        .hidden-dlc {
            display: none;
            color: var(--primary);
            font-weight: bold;
            margin-top: 5px;
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }

        /* Glitch text */
        .glitch { position: relative; }
        .glitch::before, .glitch::after {
            content: attr(data-text); position: absolute; top: 0; left: 0; width: 100%; height: 100%;
        }
        .glitch::before {
            left: 2px; text-shadow: -1px 0 red; clip: rect(24px, 550px, 90px, 0); animation: glitch-anim-2 3s infinite linear alternate-reverse;
        }
        .glitch::after {
            left: -2px; text-shadow: -1px 0 blue; clip: rect(85px, 550px, 140px, 0); animation: glitch-anim 2.5s infinite linear alternate-reverse;
        }
        @keyframes glitch-anim {
            0% { clip: rect(13px, 9999px, 81px, 0); } 20% { clip: rect(98px, 9999px, 11px, 0); } 40% { clip: rect(3px, 9999px, 58px, 0); }
            60% { clip: rect(62px, 9999px, 2px, 0); } 80% { clip: rect(24px, 9999px, 95px, 0); } 100% { clip: rect(45px, 9999px, 31px, 0); }
        }
        @keyframes glitch-anim-2 {
            0% { clip: rect(65px, 9999px, 96px, 0); } 20% { clip: rect(9px, 9999px, 4px, 0); } 40% { clip: rect(47px, 9999px, 19px, 0); }
            60% { clip: rect(83px, 9999px, 73px, 0); } 80% { clip: rect(31px, 9999px, 55px, 0); } 100% { clip: rect(94px, 9999px, 18px, 0); }
        }

        /* Ticker */
        .ticker-wrap {
            position: fixed; bottom: 0; width: 100%; overflow: hidden; height: 30px; background-color: var(--dark); padding-left: 100%; box-sizing: content-box; border-top: 2px solid var(--accent); z-index: 1000;
        }
        .ticker {
            display: inline-block; height: 30px; line-height: 30px; white-space: nowrap; padding-right: 100%; box-sizing: content-box; animation: ticker 20s linear infinite;
        }
        .ticker__item {
            display: inline-block; padding: 0 2rem; font-size: 0.7rem; color: var(--accent); font-family: 'Press Start 2P', cursive;
        }
        @keyframes ticker {
            0% { transform: translate3d(0, 0, 0); } 100% { transform: translate3d(-100%, 0, 0); }
        }

    </style>
</head>
<body>

    <div class="scanlines"></div>

    <div class="main-container">
        
        <div id="screen-1" class="screen active">
            <h1 class="glitch" data-text="THE DATE #3 SUMMIT">THE DATE #3 SUMMIT</h1>
            
            <div class="center-wrapper">
                <span class="subtitle">Agenda oficialƒÉ / Strategic Meeting</span>
            </div>

            <div style="margin: 20px 0; font-size: 3rem; text-align: center;">
                üìÇ ‚ú® üõ∞Ô∏è
            </div>

            <p style="text-align: center; font-size: 0.9rem; margin-bottom: 30px;">
                Loading high-priority logistics...<br>
                Vibe check: <span style="color:var(--secondary); font-weight:900;">IN PROGRESS</span>
            </p>

            <button class="btn-retro" onclick="startExperience()">ACCESS SYSTEM ‚ûú</button>

            <p class="disclaimer">
                *By clicking start, you agree that we re going on a banger of a date.
            </p>
        </div>

        <div id="screen-2" class="screen">
            <h2>Select Mission</h2>
            <p style="font-size: 0.8rem; margin-bottom: 20px; opacity: 0.7;">Choose your character's path.</p>

            <div class="card-container">
                <div class="option-card" onclick="selectOption(this, 'Cafea')">
                    <div class="card-header">
                        <div class="card-title">
                            <span class="card-emoji">‚òï</span> 
                            <div>Lore Dumping Session</div>
                        </div>
                        <span class="card-badge">CLASSY</span>
                    </div>
                    <div class="card-desc">
                        Ne luam cafea/ceva  »ôi facem "Yapping" intensiv..
                    </div>
                </div>

                <div class="option-card" onclick="selectOption(this, 'Plimbare')">
                    <div class="card-header">
                        <div class="card-title">
                            <span class="card-emoji">üö∂‚Äç‚ôÇÔ∏è</span> 
                            <div>Side Quest: Urban Explore</div>
                        </div>
                        <span class="card-badge">DLC</span>
                    </div>
                    <div class="card-desc">
                        Plimbare tacticƒÉ + cƒÉutare snacks. Poate T√¢rgul de CrƒÉciun? (√é»õi iau pufule»õi cu pizza daca gasim).
                    </div>
                </div>

                <div class="option-card" onclick="selectOption(this, 'Film')">
                    <div class="card-header">
                        <div class="card-title">
                            <span class="card-emoji">üçø</span> 
                            <div>Trauma Bonding (Film)</div>
                        </div>
                        <span class="card-badge">THRILLER</span>
                    </div>
                    <div class="card-desc">
                        Cinci nopti la freedy .hau hau hau.
                    </div>
                </div>
            </div>

            <div class="date-wrapper">
                <label class="date-label">DEPLOYMENT DATE (WHEN?):</label>
                <input type="date" id="date-picker" class="retro-input">
            </div>

            <div id="error-message" class="error-msg">Error 404: Mission or Date missing.</div>
            
            <button class="btn-retro" onclick="confirmChoice()" style="background-color: var(--secondary);">CONFIRM SELECTION</button>
        </div>

        <div id="final-screen" class="screen" style="text-align: center;">
            <h1 style="color: var(--secondary)">It's a Deal!</h1>
            <div style="font-size: 4rem; margin: 20px 0;">ü§ù</div>
            <p style="font-weight: bold; margin-bottom: 20px;">Alegerea »ôi data au fost salvate.</p>
            <p>I'll handle the rest. See you there.</p>
            <div style="margin-top: 30px; font-family: monospace; background: #000; color: #0f0; padding: 10px;">
                > STATUS: LOCKED IN<br>
                > EXCITEMENT_LEVEL: 100%
            </div>
        </div>

        <footer id="secret-footer">
            v2.2 | Department of Good Times
            <div class="hidden-dlc" id="dlc-msg">
                üèÜ ACHIEVEMENT UNLOCKED: √é»õi iau »ôi desert.
            </div>
        </footer>

    </div>

    <div class="ticker-wrap">
        <div class="ticker">
            <div class="ticker__item">BREAKING NEWS: MAJOR VIBE SHIFT DETECTED.</div>
            <div class="ticker__item">CURRENT STATUS: WAITING FOR USER INPUT.</div>
            <div class="ticker__item">WEATHER FORECAST: 100% CHANCE OF FUN.</div>
            <div class="ticker__item">DON'T FORGET TO BRING YOUR SMILE.</div>
        </div>
    </div>

    <script>
        let selectedChoice = null;

        // Audio Engine
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playBeep(freq = 600, type = 'sine', duration = 0.1) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.type = type;
            osc.frequency.value = freq;
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            osc.start();
            gainNode.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + duration);
            osc.stop(audioCtx.currentTime + duration);
        }

        function playSuccessSound() {
            playBeep(400, 'square', 0.1);
            setTimeout(() => playBeep(600, 'square', 0.1), 100);
            setTimeout(() => playBeep(1000, 'square', 0.3), 200);
        }

        function playHoverSound() {
             playBeep(800, 'sine', 0.05);
        }

        function startExperience() {
            playBeep(600, 'triangle', 0.1);
            document.getElementById('screen-1').classList.remove('active');
            setTimeout(() => {
                document.getElementById('screen-2').classList.add('active');
            }, 100);
        }

        function selectOption(card, choiceName) {
            playHoverSound();
            document.querySelectorAll('.option-card').forEach(c => c.classList.remove('selected'));
            card.classList.add('selected');
            selectedChoice = choiceName;
            document.getElementById('error-message').style.display = 'none';
        }

        function confirmChoice() {
            const errorMsg = document.getElementById('error-message');
            const dateValue = document.getElementById('date-picker').value;
            
            // VALIDATION: Check if both choice AND date are selected
            if (!selectedChoice || !dateValue) {
                playBeep(150, 'sawtooth', 0.3); // Error buzz
                errorMsg.innerText = "Error 404: Mission or Date missing.";
                errorMsg.style.display = 'block';
                return;
            }

            playSuccessSound();
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 },
                colors: ['#FF90E8', '#23A6D5', '#FFC900']
            });

            // SEND DATA (Option + Date)
            fetch('/choice', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ 
                    option: selectedChoice,
                    date: dateValue 
                }),
            })
            .then(response => response.json())
            .then(data => console.log('Sent:', data))
            .catch((error) => console.error('Error:', error));

            document.getElementById('screen-2').classList.remove('active');
            document.getElementById('final-screen').classList.add('active');
        }

        document.querySelectorAll('.option-card, .btn-retro').forEach(el => {
            el.addEventListener('mouseenter', () => playHoverSound());
        });

        // Easter Egg
        const footer = document.getElementById('secret-footer');
        const dlcMsg = document.getElementById('dlc-msg');
        let hoverTimer;

        footer.addEventListener('mouseenter', () => {
            hoverTimer = setTimeout(() => {
                playBeep(1200, 'sine', 0.2); 
                dlcMsg.style.display = 'block';
            }, 2000); 
        });

        footer.addEventListener('mouseleave', () => {
            clearTimeout(hoverTimer);
            dlcMsg.style.display = 'none';
        });

        footer.addEventListener('touchstart', () => {
            hoverTimer = setTimeout(() => {
                playBeep(1200, 'sine', 0.2);
                dlcMsg.style.display = 'block';
            }, 2000);
        });

        footer.addEventListener('touchend', () => {
            clearTimeout(hoverTimer);
            setTimeout(() => {
               if(dlcMsg.style.display === 'block') dlcMsg.style.display = 'none'; 
            }, 3000);
        });
    </script>
</body>
</html>